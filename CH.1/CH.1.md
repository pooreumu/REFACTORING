# 1.4 statement() 함수 쪼개기

## play 변수 제거하기

### 지역 변수를 제거해서 얻는 가장 큰 장점

-   추출 작업이 훨씬 쉬워진다
    -   유효범위를 신경 써야 할 대상이 줄어들기 때문

플레이 변수 제거 하면서 기존에 루프를 한 번 돌 때마다 공연을 한 번 조회하던 것이 세 번이나 조회하도록 바뀌어 성능이 안좋아 지는 거 아닌가? 하는 생각이 들었는데 책에서도 바로 이 부분에 대해서 얘기한다. **성능에 큰 영향은 없다** 라고, 생각해보면 시간 복잡도에서 최고 차항을 제외한 모든 항과 최고차항의 계수를 제외시킨다.

실제 테스트 해봤을 때 변경 전 후 함수 실행 시간은 8ms ~ 9ms로 차이가 없다.

또한 제대로 리팩터링된 코드베이스는 성능을 개선하기가 훨씬 쉽다고 한다.

## volumeCredits 변수 제거하기

### volumeCredits 변수를 제거하는 작업의 단계:

-   각 단계마다 컴파일 - 테스트 - 커밋한다.

1. 반복문 쪼개기
    - 변수 값을 누적시키는 부분을 분리한다.
2. 문장 슬라이드하기
    - 변수 초기화 문장을 변수 값 누적 코드 바로 앞으로 옮긴다.
3. 함수 추출하기
    - 적립 포인트 계산 부분을 별도 함수로 추출한다.
4. 변수 인라인하기
    - volumeCredits변수를 제거한다.

리팩터링 중간에 테스트가 실패하고 원인을 바로 찾지 못하면 가장 최근 커밋으로 돌아가서 테스트에 실패한 리팩터링 단계를 더 작게 나눠 다시 시도한다.

# 1.8 다형성을 활용해 계산 코드 재구성하기

## 공연료 계산기를 다형성 버전으로 만들기

1. 타입 코드를 서브클래스로 바꾸기
2. 생성자를 팩터리 함수로 바꾸기
    - js에서는 생성자가 서브클래스의 인스턴스를 반환활 수 없기 때문
